<p id="notice"><%= notice %></p>

<p>
  <strong>社員コード:</strong>
  <%= @emp.code %>
</p>

<p>
  <strong>氏名:</strong>
  <%= @emp.name %>
</p>

<table>
    <thead>
    <tr>
      <th width="60" >日付</th>
      <th width="60" >休日</th>
      <th width="60" >勤務</th>
      <th width="60" >出勤</th>
      <th width="60" >始業</th>
      <th width="60" >終業</th>
      <th width="60" >退勤</th>
      <th width="40" >休憩</th>
      <th width="80" >アラーム</th>
      <th width="120" >乖離理由</th>
      <th width="120" >備考</th>
      <th width="120" >上長確認</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <br>
  <tbody>
    <% @worklogs.each do |worklog| %>
      <tr>
        <td><%= worklog.workday.strftime("%m/%d")  %></td>
        <td><%= worklog.holidaytype.name %></td>
        <td><%= worklog.worktype.name %></td>
        <td><%= worklog.rc_start.strftime("%H:%M") %></td>
        <td><%= worklog.wk_start.strftime("%H:%M")  %></td>
        <td><%= worklog.wk_end.strftime("%H:%M")  %></td>
        <td><%= worklog.rc_end.strftime("%H:%M")  %></td>
        <td align=right ><%= worklog.rest %></td>
        <td align=center >
          <% if worklog.over_work_in_day? %>
            <font color="#ff0000">10時間超</font>
          <% end %>
        </td>
        <td><%= worklog.reason %></td>
        <td><%= worklog.comment %></td>
        <td><%= worklog.check %></td>
        <td><%= link_to '詳細', worklog %></td>
        <td><%= link_to '編集', edit_worklog_path(worklog) %></td>
        <td><%= link_to '削除', worklog, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
  
<br>
<form>
  <input id="display_chart0" type="button" value="グラフ表示" onclick="visualize(0)">
  <input id="display_chart1" type="button" value="グラフ非表示"   onclick="visualize(1)">
</form>

<br />
  <div id="chart_div"></div>
<br />

<%= link_to 'Edit', edit_emp_path(@emp) %> |
<%= link_to 'Back', emps_path %>

<!------------------------------------------------------------------------>
<!-- AJAX API のロード -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">

// Visualization API と折れ線グラフ用のパッケージのロード
google.load("visualization", "1", {packages:["barchart"]});

// Google Visualization API ロード時のコールバック関数の設定
google.setOnLoadCallback(drawChart);

// グラフ作成用のコールバック関数
function drawChart() {

	// データテーブルの作成
	var dataTable = new google.visualization.DataTable();

  dataTable.addColumn({ type: 'string', id: 'date' });
  dataTable.addColumn({ type: 'number', id: 'hrs' });
    
  for (var row in gon.graph_data){
 	  //dataTable.addRow([ gon.graph_data[row][0], gon.graph_data[row][1] ])
 	  dataTable.addRow([ gon.graph_data[row][0], gon.graph_data[row][1] ])
 	  };
  
  
  // グラフのオプションを設定
	var options = { title: '就業実績',
        width: 1200,
        height: 400,
        legend: { position: "none" },
        vAxis:  {title: "日付",  titleTextStyle: {fontSize: 12,}, },                 
        hAxis:  {title: '勤務時間',  titleTextStyle: {fontSize: 12,}, },
        backgroundColor: '#e5e4e2',
      };
	// Chart のオブジェクトの作成
	var chart = new google.visualization.BarChart(document.getElementById('chart_div'));

	// データテーブルとオプションを渡して、グラフを描画
	chart.draw(dataTable, options);

}
  
function visualize(num)
{
  if (num == 0)
  {
    document.getElementById("chart_div").style.display="block";
  }
  else
  {
    document.getElementById("chart_div").style.display="none";
  }
}  
  
</script>
